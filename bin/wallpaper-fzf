#!/usr/bin/env bash

CONFIG_FILE="$HOME/.config/hypr/hyprpaper.conf"
WALLPAPER_DIR="$HOME/pics/backgrounds"

WALLPAPER=$(find "$WALLPAPER_DIR" -mindepth 1 | fzf --preview 'kitty icat --clear --transfer-mode=memory --stdin=no --place="${FZF_PREVIEW_COLUMNS}x${FZF_PREVIEW_LINES}@0x0" {} '
)

if [[ -n "$WALLPAPER" ]]; then

    echo "preload = $WALLPAPER" > "$CONFIG_FILE"
    echo "wallpaper = , $WALLPAPER" >> "$CONFIG_FILE"

    killall hyprpaper
    hyprpaper &>/dev/null &
fi
